##########
####  wangwenbo@alibaba-inc.com
##########

include ./make.inc

WORKSPACE=.
TMP=$(WORKSPACE)/build/main.groovy

VERSION=1.0.0.1
OS=`uname -s`
CYGWIN_NT="CYGWIN_NT-10.0"
$(TMP):clean
	[ -d "./build" ] && echo "has dist dir" || mkdir -p ./build

####all build 
concat:$(TMP)
	echo -e "//verion=$(VERSION) \n" > $(TMP)
	$(call __definedir__,$(WORKSPACE)/com/agent/, $(TMP));

###repalce 
replace:
	$(call __replaceWindowsImport__ ,$(TMP))
	
clean:
	rm -rf $(WORKSPACE)/build/* 

all:clean concat replace
	cd ./build && /bin/groovy/bin/groovyc main.groovy && rm -f $(TMP)
	tar zcf app.jar ./build && rm -rf ./build/* && mv app.jar ./build
	echo "done";
